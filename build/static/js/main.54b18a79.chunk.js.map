{"version":3,"sources":["components/VKLogin/index.js","components/VKLogin/VKLogin.jsx","App.js","index.js"],"names":["VKLogin","props","_this","Object","classCallCheck","this","possibleConstructorReturn","getPrototypeOf","call","statusChangeCallback","response","status","console","log","setState","loggedStatus","userID","session","mid","getPersonalData","getFriends","checkLoginStatus","window","VK","Auth","getLoginStatus","handleLogin","login","errorMessage","access","FRIENDS","handleLogout","logout","Api","user_ids","state","fields","v","r","picture","photo_100","firstName","first_name","lastName","last_name","online","order","name_case","count","friendList","items","showData","friends","map","friend","fullName","concat","react_default","a","createElement","key","id","className","src","alt","width","_this2","vkAsyncInit","init","apiId","Observer","subscribe","setTimeout","el","document","type","async","getElementById","appendChild","Fragment","onClick","React","Component","App","components_VKLogin","ReactDOM","render","src_App","navigator","serviceWorker","register","then","catch","error"],"mappings":"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","file":"static/js/main.54b18a79.chunk.js","sourcesContent":["import VKLogin from './VKLogin';\n\nexport default VKLogin;\n","import React from 'react';\n\nclass VKLogin extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      loggedStatus: false,\n      userID: '',\n      firstName: '',\n      lastName: '',\n      friendList: [],\n      online: false,\n      errorMessage: '',\n    };\n  }\n\n  componentDidMount() {\n    window.vkAsyncInit = () => {\n      window.VK.init({\n        apiId: 7031686,\n      });\n\n      window.VK.Observer.subscribe('auth.statusChange', response => {\n        this.statusChangeCallback(response);\n      });\n      this.checkLoginStatus();\n    };\n\n    setTimeout(() => {\n      var el = document.createElement('script');\n      el.type = 'text/javascript';\n      el.src = 'https://vk.com/js/api/openapi.js?161';\n      el.async = true;\n      document.getElementById('vk_api_transport').appendChild(el);\n    }, 0);\n  }\n\n  statusChangeCallback = response => {\n    if (response.status === 'connected') {\n      console.log(response);\n      this.setState({\n        loggedStatus: true,\n        userID: response.session.mid,\n      });\n      this.getPersonalData();\n      this.getFriends();\n    } else {\n      this.setState({\n        loggedStatus: false,\n      });\n    }\n  };\n\n  checkLoginStatus = () => {\n    window.VK.Auth.getLoginStatus(response =>\n      this.statusChangeCallback(response)\n    );\n  };\n\n  handleLogin = () => {\n    window.VK.Auth.login(\n      response => {\n        if (response.session) {\n          console.log(response);\n          this.setState({\n            errorMessage: '',\n          });\n        } else {\n          this.setState({\n            errorMessage: 'User clicked Cancel in the login window.',\n          });\n        }\n      },\n      [window.VK.access.FRIENDS]\n    );\n  };\n\n  handleLogout = () => {\n    window.VK.Auth.logout();\n  };\n\n  getPersonalData = () => {\n    window.VK.Api.call(\n      'users.get',\n      {\n        user_ids: this.state.userID,\n        fields: 'photo_100,online',\n        v: '5.95',\n      },\n      r => {\n        if (r.response) {\n          this.setState({\n            picture: r.response[0].photo_100,\n            firstName: r.response[0].first_name,\n            lastName: r.response[0].last_name,\n            online: r.response[0].online,\n          });\n        }\n      }\n    );\n  };\n\n  getFriends = () => {\n    window.VK.Api.call(\n      'friends.get',\n      {\n        user_ids: this.state.userID,\n        order: 'hints',\n        fields: 'first_name,last_name',\n        name_case: 'nom',\n        count: '10',\n        v: '5.95',\n      },\n      r => {\n        if (r.response) {\n          this.setState({\n            friendList: r.response.items,\n          });\n        }\n      }\n    );\n  };\n\n  showData = () => {\n    if (this.state.loggedStatus) {\n      const friends = this.state.friendList.map(friend => {\n        const fullName = `${friend.first_name} ${friend.last_name}`;\n        return <li key={friend.id}>{fullName}</li>;\n      });\n      const fullName = `${this.state.firstName} ${this.state.lastName}`;\n\n      return (\n        <div className=\"row\">\n          <div className=\"col-auto\">\n            <img\n              className=\"img-thumbnail\"\n              src={this.state.picture}\n              alt=\"avatar\"\n              width=\"300\"\n            />\n          </div>\n          <div className=\"col\">\n            <h3>{fullName}</h3>\n            {this.state.online ? <p>Online</p> : <p>Offline</p>}\n            <ul className=\"list-unstyled\">{friends}</ul>\n          </div>\n        </div>\n      );\n    }\n  };\n\n  render() {\n    return (\n      <>\n        <div id=\"vk_api_transport\" />\n        <div>{this.showData()}</div>\n        {this.state.loggedStatus ? (\n          <button className=\"btn btn-primary\" onClick={this.handleLogout}>\n            Logout\n          </button>\n        ) : (\n          <button className=\"btn btn-primary\" onClick={this.handleLogin}>\n            Login\n          </button>\n        )}\n        {this.state.errorMessage ? <p>{this.state.errorMessage}</p> : null}\n      </>\n    );\n  }\n}\n\nexport default VKLogin;\n","import React from 'react';\nimport VKLogin from '@/components/VKLogin';\n\nconst App = () => {\n  return (\n    <div className=\"container pt-5\">\n      <VKLogin />\n    </div>\n    \n  );\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport 'bootstrap/dist/css/bootstrap.min.css'\nimport App from './App';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\nconst registerServiceWorker = () => {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker\n      .register('sw.js')\n      .then(() => (console.log(\"Service worker registered\")))\n      .catch((error) => {\n        console.error('Registration failed, error:', error);\n      });\n  }\n};\n\nregisterServiceWorker();\n"],"sourceRoot":""}